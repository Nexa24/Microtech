# üî• Firebase Courses Collection - Setup Guide

## üìã Overview

The **courses** collection in Firebase Firestore is configured and ready to store all course data for the MicroTech Admin Panel.

---

## üóÑÔ∏è Collection Structure

### Collection Name: `courses`

### Document Structure

```javascript
{
  // Auto-generated by Firestore
  id: "auto-generated-document-id",
  
  // Auto-generated by application
  courseID: "CRS-1697123456789-ABC123DEF",
  createdAt: Timestamp { seconds: 1697123456, nanoseconds: 789000000 },
  updatedAt: Timestamp { seconds: 1697123456, nanoseconds: 789000000 },
  
  // Required Fields
  name: "Full Stack Web Development",
  division: "CAPT", // "CAPT" | "LBS" | "Gama"
  duration: 6, // in months
  totalFee: 50000, // in rupees
  admissionFee: 5000, // in rupees
  status: "Active", // "Active" | "Inactive"
  
  // Optional Fields
  description: "Complete course covering HTML, CSS, JavaScript, React, Node.js...",
  imageURL: "https://example.com/course-image.jpg",
  startDate: "2025-01-15", // ISO date string
  endDate: "2025-07-15", // ISO date string
  
  // Array Fields
  providers: ["John Doe", "Jane Smith", "Prof. Kumar"],
  studentsEnrolled: ["student-id-1", "student-id-2", "student-id-3"]
}
```

---

## üîí Security Rules (Already Configured)

Your Firestore security rules for the courses collection:

```javascript
match /courses/{course} {
  // Allow read for authenticated users
  allow read: if isAuthenticated();
  
  // Allow write only for admins
  allow write: if hasRole('admin');
}
```

### What This Means:
- ‚úÖ **Read Access**: Any authenticated user can view courses
- ‚úÖ **Write Access**: Only admins can create, update, or delete courses
- ‚úÖ **Security**: Non-authenticated users cannot access the data

---

## üöÄ Quick Start - Adding Your First Course

### Method 1: Using the UI (Recommended)

1. Open `courses.html` in your browser
2. Click the **"Add Course"** button
3. Fill in the form:
   - **Course Name**: e.g., "Digital Marketing"
   - **Division**: Select CAPT, LBS, or Gama
   - **Duration**: e.g., 6 (months)
   - **Total Fee**: e.g., 50000
   - **Admission Fee**: e.g., 5000
   - **Status**: Select Active or Inactive
   - **Description**: Add details (optional)
   - **Image URL**: Add image link (optional)
   - **Providers**: Add teacher names (optional)
4. Click **"Save Course"**
5. Course will be saved to Firestore automatically

### Method 2: Using Firebase Console

1. Go to [Firebase Console](https://console.firebase.google.com/)
2. Select your project: **microtech-88235**
3. Navigate to **Firestore Database**
4. Click **"Start collection"** (if first time) or **"Add collection"**
5. Collection ID: `courses`
6. Add a document with the structure above

### Method 3: Using JavaScript (Manual)

```javascript
import { collection, addDoc, serverTimestamp } from 'firebase/firestore';

const courseData = {
  courseID: `CRS-${Date.now()}-${Math.random().toString(36).substr(2, 9).toUpperCase()}`,
  name: "Python Programming",
  division: "CAPT",
  duration: 4,
  totalFee: 35000,
  admissionFee: 3500,
  status: "Active",
  description: "Learn Python from basics to advanced",
  imageURL: "",
  startDate: "2025-02-01",
  endDate: "2025-06-01",
  providers: ["Dr. Sharma"],
  studentsEnrolled: [],
  createdAt: serverTimestamp(),
  updatedAt: serverTimestamp()
};

await addDoc(collection(db, 'courses'), courseData);
```

---

## üìä Sample Data

Here are 3 sample courses you can add to test:

### Course 1: CAPT Division
```json
{
  "courseID": "CRS-1697123456789-CAPT001",
  "name": "Full Stack Web Development",
  "division": "CAPT",
  "duration": 6,
  "totalFee": 50000,
  "admissionFee": 5000,
  "status": "Active",
  "description": "Complete web development course covering frontend and backend technologies",
  "imageURL": "https://images.unsplash.com/photo-1498050108023-c5249f4df085",
  "startDate": "2025-01-15",
  "endDate": "2025-07-15",
  "providers": ["John Doe", "Jane Smith"],
  "studentsEnrolled": []
}
```

### Course 2: LBS Division
```json
{
  "courseID": "CRS-1697123456790-LBS001",
  "name": "Digital Marketing Professional",
  "division": "LBS",
  "duration": 3,
  "totalFee": 35000,
  "admissionFee": 3500,
  "status": "Active",
  "description": "Master digital marketing strategies, SEO, social media, and analytics",
  "imageURL": "https://images.unsplash.com/photo-1460925895917-afdab827c52f",
  "startDate": "2025-02-01",
  "endDate": "2025-05-01",
  "providers": ["Prof. Kumar"],
  "studentsEnrolled": []
}
```

### Course 3: Gama Division
```json
{
  "courseID": "CRS-1697123456791-GAMA001",
  "name": "Fashion Design Fundamentals",
  "division": "Gama",
  "duration": 12,
  "totalFee": 80000,
  "admissionFee": 10000,
  "status": "Active",
  "description": "Comprehensive fashion design course covering sketching, fabrics, and garment construction",
  "imageURL": "https://images.unsplash.com/photo-1558769132-cb1aea1c036",
  "startDate": "2025-01-10",
  "endDate": "2026-01-10",
  "providers": ["Aisha Khan", "Rajesh Malhotra"],
  "studentsEnrolled": []
}
```

---

## üîç Querying the Courses Collection

### Basic Queries (JavaScript)

```javascript
import { collection, getDocs, query, where, orderBy } from 'firebase/firestore';

// Get all courses
const allCourses = await getDocs(collection(db, 'courses'));

// Get active courses only
const activeCoursesQuery = query(
  collection(db, 'courses'),
  where('status', '==', 'Active')
);
const activeCourses = await getDocs(activeCoursesQuery);

// Get courses by division
const captCoursesQuery = query(
  collection(db, 'courses'),
  where('division', '==', 'CAPT')
);
const captCourses = await getDocs(captCoursesQuery);

// Get courses ordered by creation date
const recentCoursesQuery = query(
  collection(db, 'courses'),
  orderBy('createdAt', 'desc')
);
const recentCourses = await getDocs(recentCoursesQuery);

// Get courses by fee range
const affordableCoursesQuery = query(
  collection(db, 'courses'),
  where('totalFee', '<=', 40000)
);
const affordableCourses = await getDocs(affordableCoursesQuery);
```

---

## üîÑ CRUD Operations

### Create (Add New Course)
```javascript
import { collection, addDoc, serverTimestamp } from 'firebase/firestore';

const newCourse = {
  courseID: generateCourseID(),
  name: "Course Name",
  division: "CAPT",
  duration: 6,
  totalFee: 50000,
  admissionFee: 5000,
  status: "Active",
  description: "Course description",
  imageURL: "",
  startDate: "2025-01-15",
  endDate: "2025-07-15",
  providers: [],
  studentsEnrolled: [],
  createdAt: serverTimestamp(),
  updatedAt: serverTimestamp()
};

const docRef = await addDoc(collection(db, 'courses'), newCourse);
console.log("Course added with ID:", docRef.id);
```

### Read (Get Course)
```javascript
import { doc, getDoc } from 'firebase/firestore';

const courseRef = doc(db, 'courses', courseId);
const courseSnap = await getDoc(courseRef);

if (courseSnap.exists()) {
  console.log("Course data:", courseSnap.data());
} else {
  console.log("Course not found");
}
```

### Update (Modify Course)
```javascript
import { doc, updateDoc, serverTimestamp } from 'firebase/firestore';

const courseRef = doc(db, 'courses', courseId);
await updateDoc(courseRef, {
  name: "Updated Course Name",
  totalFee: 55000,
  updatedAt: serverTimestamp()
});
```

### Delete (Remove Course)
```javascript
import { doc, deleteDoc } from 'firebase/firestore';

const courseRef = doc(db, 'courses', courseId);
await deleteDoc(courseRef);
```

---

## üìà Indexes (For Complex Queries)

If you need to perform complex queries (multiple where clauses), you may need to create indexes in Firebase Console.

### Common Indexes Needed:

1. **Division + Status**
   ```
   Collection: courses
   Fields: division (Ascending), status (Ascending)
   ```

2. **Status + CreatedAt**
   ```
   Collection: courses
   Fields: status (Ascending), createdAt (Descending)
   ```

3. **Division + TotalFee**
   ```
   Collection: courses
   Fields: division (Ascending), totalFee (Ascending)
   ```

Firebase will prompt you to create these when needed.

---

## üîê User Roles & Permissions

### Admin Role
- ‚úÖ Create courses
- ‚úÖ Edit courses
- ‚úÖ Delete courses
- ‚úÖ View all courses

### Counselor Role
- ‚ùå Cannot create courses
- ‚ùå Cannot edit courses
- ‚ùå Cannot delete courses
- ‚úÖ View all courses

### Teacher Role
- ‚ùå Cannot create courses
- ‚ùå Cannot edit courses (except assigned courses)
- ‚ùå Cannot delete courses
- ‚úÖ View assigned courses only

### Student Role
- ‚ùå Cannot create courses
- ‚ùå Cannot edit courses
- ‚ùå Cannot delete courses
- ‚úÖ View enrolled courses only

---

## üß™ Testing the Setup

### 1. Check Firebase Connection
```javascript
// In browser console
console.log('Firebase Config:', firebaseConfig);
console.log('Firestore:', db);
```

### 2. Test Read Access
```javascript
// Try fetching courses
const coursesRef = collection(db, 'courses');
const snapshot = await getDocs(coursesRef);
console.log(`Found ${snapshot.size} courses`);
```

### 3. Test Write Access (Admin only)
```javascript
// Try adding a test course
const testCourse = {
  courseID: "TEST-001",
  name: "Test Course",
  division: "CAPT",
  duration: 1,
  totalFee: 1000,
  admissionFee: 100,
  status: "Inactive",
  description: "Test",
  providers: [],
  studentsEnrolled: [],
  createdAt: serverTimestamp(),
  updatedAt: serverTimestamp()
};

await addDoc(collection(db, 'courses'), testCourse);
```

---

## üêõ Troubleshooting

### Issue 1: Permission Denied
**Error**: `Missing or insufficient permissions`

**Solution**: 
1. Check if user is authenticated
2. Check if user has admin role
3. Verify Firestore rules are deployed

### Issue 2: Collection Not Found
**Error**: Collection doesn't appear in Firebase Console

**Solution**:
1. Add at least one document
2. Collections are created on first document write
3. Refresh Firebase Console

### Issue 3: Timestamp Not Working
**Error**: `createdAt` or `updatedAt` is null

**Solution**:
```javascript
// Use serverTimestamp() from Firebase
import { serverTimestamp } from 'firebase/firestore';

const data = {
  createdAt: serverTimestamp(),
  updatedAt: serverTimestamp()
};
```

### Issue 4: Real-time Updates Not Working
**Solution**:
```javascript
// Use onSnapshot for real-time updates
import { onSnapshot } from 'firebase/firestore';

const unsubscribe = onSnapshot(
  collection(db, 'courses'),
  (snapshot) => {
    snapshot.docChanges().forEach((change) => {
      console.log('Change type:', change.type);
      console.log('Data:', change.doc.data());
    });
  }
);
```

---

## üìä Firebase Console Access

### To Manage Courses in Firebase Console:

1. Go to: https://console.firebase.google.com/
2. Project: **microtech-88235**
3. Click **"Firestore Database"** in left menu
4. You'll see the **courses** collection
5. Click on a document to view/edit
6. Use filters and queries in the console

---

## üîó Related Collections

Your courses can be linked with:

- **students** collection (via studentsEnrolled array)
- **staff** collection (via providers array)
- **fees** collection (for payment tracking)
- **users** collection (for role management)

---

## üìù Field Validation Rules

### Implemented in JavaScript:
```javascript
// Required fields
- name: string, min 3 chars
- division: "CAPT" | "LBS" | "Gama"
- duration: number, min 1 month
- totalFee: number, min 0
- admissionFee: number, min 0
- status: "Active" | "Inactive"

// Optional fields
- description: string
- imageURL: valid URL or empty
- startDate: ISO date string
- endDate: ISO date string
- providers: array of strings
- studentsEnrolled: array of strings
```

---

## üöÄ Next Steps

1. ‚úÖ Firebase configured
2. ‚úÖ Firestore rules set
3. ‚úÖ Collection structure defined
4. ‚úÖ UI ready (courses.html)
5. ‚úÖ JavaScript ready (courses.js)

**You're ready to start adding courses!**

---

## üìû Support

If you encounter issues:
1. Check browser console (F12) for errors
2. Check Firebase Console for collection data
3. Verify authentication status
4. Review Firestore rules
5. Check network connectivity

---

## üéâ Summary

Your Firebase `courses` collection is:
- ‚úÖ Properly configured
- ‚úÖ Security rules applied
- ‚úÖ Ready for CRUD operations
- ‚úÖ Connected to your UI
- ‚úÖ Real-time sync enabled

**Start managing courses now!** üöÄ

---

**Project**: MicroTech Admin Panel  
**Collection**: courses  
**Firebase Project**: microtech-88235  
**Status**: ‚úÖ Ready for Production
